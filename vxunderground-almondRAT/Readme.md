# almondRAT
https://vx-underground.org/Samples/Families/AlmondRAT
<br> <br> 

![image](https://github.com/user-attachments/assets/1560e26b-ea7c-428b-9e71-1efb5dce81c5)

Doing analysis on the file type shows that it's a dotnet exe. So loading it into dnspy will give us an easier time reversing it due to the nature of C# 
<br> <br> 
Looking at the main function of the program it's calling Mutex <br> 
![image](https://github.com/user-attachments/assets/d5c7ec9f-5975-44ad-8a37-4f98b7bab2c5)
<br> 
This resource gives a pretty good explanation of what Mutex does. 
<br> https://dotnettutorials.net/lesson/mutex-in-multithreading/#google_vignette <br> 
Essentially it checks if the program is currently running, if it is then it will not execute the Program.StartClient function. Otherwise, the program will continue execution. This is a good way to track if the malware is already being ran on the system. 

<br> I'm going to be doing some dynamic analysis to see what some other values are in the functions. To make sure that the program continues running im going to edit the Program class to make sure it continues no matter what. 
<br> 
![image](https://github.com/user-attachments/assets/5e44888c-1081-4fb8-8157-d163eb9d71cc)

<br> ![image](https://github.com/user-attachments/assets/b9c8008f-b9a0-4ade-af03-8eb556b744de)
<br> ![image](https://github.com/user-attachments/assets/bf15e995-29b4-4638-aa90-167210d9b808)

<br> Now we can follow along to see if there will be any potential hidden data going through the program while it's running 
<br> Running it and stepping line by line we see that there's some base64 encoded text. Once its decrypted it leads to an ip. Could be there C2 server. <br> 
![image](https://github.com/user-attachments/assets/ac1f28fc-7ce0-437d-a4aa-f16887bebfa4)
<br> ![image](https://github.com/user-attachments/assets/addc4e48-2aa3-4ee0-b40b-d9b245707d66)
<br> 

It proceeds to get all the info from the computer like the os name and drives. Then it initiates a connection 
<br> 
![image](https://github.com/user-attachments/assets/67b65f3b-8f11-4b7f-9b0b-badc9a91c0b4)
<br> further edits are going to made so the program continues execution despite not connecting to the server <br> 
![image](https://github.com/user-attachments/assets/8e4f222e-107b-4941-b915-672ff4d16e2f)
<br> ![image](https://github.com/user-attachments/assets/970f108d-6991-4232-946b-f939134b9a6c)
<br> 




